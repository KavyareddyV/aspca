<template>
    <lightning-card>
        <template if:true={loading}>
            <lightning-spinner
                alternative-text="Loading session data"
                variant="brand"
            ></lightning-spinner>
        </template>
        <div class="slds-page-header slds-page-header_joined slds-page-header_bleed slds-shrink-none test-headerRegion slds-is-relative slds-page-header--object-home">
            <h2 class="slds-card__header-title">
                <lightning-icon icon-name="custom:custom63" alternative-text="Protocol" title="Protocol"></lightning-icon>
                <div class="slds-p-left_small">
                Session Protocols ({activeProtocols.length})
                <lightning-button variant="Neutral" label="Start Session" title="startSession" onclick={handleClick} class="slds-m-left_x-small"></lightning-button>
                <lightning-button variant="Neutral" label="Modify Session" title="modifySession" onclick={handleClick} class="slds-m-left_x-small"></lightning-button>
                </div>
            </h2>
        </div>
        <template if:true={activeProtocols}>
            <div class="slds-p-top_x-small">
                <template if:false={activeSession}>
                    <lightning-datatable
                        key-field="Id"
                        data={activeProtocols}
                        columns={columns}
                        hide-checkbox-column
                    >
                    </lightning-datatable>
                </template> 
                <template if:true={activeSession}>
                    <template for:each={activeProtocols} for:item="protocol">
                        <c-treatment-session-protocol
                            key={protocol.Id}
                            record-id={protocol.Id}
                            session-id={recordId}
                            protocol-name={protocol.ProtocolId__r.Name}
                            >
                        </c-treatment-session-protocol>
                    </template>
                </template>
            </div>
        </template>
    </lightning-card>
<!-- </template> -->

</br>
    <lightning-card>
        <template if:true={loading}>
            <lightning-spinner
                alternative-text="Loading session data"
                variant="brand"
            ></lightning-spinner>
        </template>
        <div class="slds-page-header slds-page-header_joined slds-page-header_bleed slds-shrink-none test-headerRegion slds-is-relative slds-page-header--object-home">
            <h2 class="slds-card__header-title">
                <lightning-icon icon-name="custom:custom63" alternative-text="Protocol" title="Protocol"></lightning-icon>
                <div class="slds-p-left_small">
                Session Protocols ({activeProtocols.length})
                <lightning-button variant="Neutral" label="Start Session" title="startSession" onclick={handleClick} class="slds-m-left_x-small"></lightning-button>
                <lightning-button variant="Neutral" label="Modify Session" title="modifySession" onclick={handleClick} class="slds-m-left_x-small"></lightning-button>
                </div>
            </h2>
        </div>
        <template if:true={activeProtocols}>
            <div class="slds-p-top_x-small">
                <template if:false={activeSession}>
                    <lightning-datatable
                        key-field="Id"
                        data={activeProtocols}
                        columns={columns}
                        hide-checkbox-column
                    >
                    </lightning-datatable>
                </template> 
                <template if:true={activeSession}>
                    <template for:each={activeProtocols} for:item="protocol">
                        <c-treatment-session-protocol
                            key={protocol.Id}
                            record-id={protocol.Id}
                            session-id={recordId}
                            protocol-name={protocol.ProtocolId__r.Name}
                            show-picklist={showPicklist}
                            >
                        </c-treatment-session-protocol>
                    </template>
                </template>
            </div>
        </template>
    </lightning-card>
</template>

<!-- <div class="slds-page-header slds-page-header_joined slds-page-header_bleed slds-shrink-none test-headerRegion slds-is-relative slds-page-header--object-home">
    <div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-grid">
        <div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-col slds-has-flexi-truncate firstHeaderRow">
            <div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-media slds-no-space slds-grow">
                <force-highlights-icon lst-listviewmanagerheader_listviewmanagerheader="" aria-hidden="true">
                    <force-record-avatar force-recordavatar_recordavatar-host=""><span force-recordavatar_recordavatar="" class="record-avatar-container slds-avatar slds-avatar_small icon slds-m-right_small" style="background-color: #7ccf60"><img force-recordavatar_recordavatar="" src="https://aspcafir--stevendev.my.salesforce.com/img/icon/t4v35/custom/custom63_120.png" title="Session Protocols" alt=""></span></force-record-avatar></force-highlights-icon><div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-media__body slds-align-middle"><lst-breadcrumbs lst-listviewmanagerheader_listviewmanagerheader=""></lst-breadcrumbs><h2 lst-listviewmanagerheader_listviewmanagerheader="" class="slds-card__header-title"><a lst-listviewmanagerheader_listviewmanagerheader="" href="/lightning/r/a1v01000000Uhg1AAC/related/Session_Protocols__r/view" class="slds-card__header-link baseCard__header-title-container"><span lst-listviewmanagerheader_listviewmanagerheader="" title="Session Protocols" class="slds-truncate slds-m-right--xx-small">Session Protocols</span><span lst-listviewmanagerheader_listviewmanagerheader="" title="(9)" class="lds-shrink-none slds-m-right--xx-small">(9)</span></a></h2></div></div></div><div lst-listviewmanagerheader_listviewmanagerheader=""><div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-col slds-no-flex slds-grid slds-align-bottom"><lst-list-view-manager-settings-menu lst-listviewmanagerheader_listviewmanagerheader="" class="slds-m-left_xx-small" lst-listviewmanagersettingsmenu_listviewmanagersettingsmenu-host=""><div lst-listviewmanagersettingsmenu_listviewmanagersettingsmenu="" class="test-listViewSettingsMenu slds-m-left_xx-small simpleEmptyState"><lightning-button-menu lst-listviewmanagersettingsmenu_listviewmanagersettingsmenu="" class="slds-dropdown-trigger slds-dropdown-trigger_click"><button aria-expanded="false" title="List View Controls" value="" aria-haspopup="true" type="button" class="slds-button slds-button_icon slds-button_icon-more"><lightning-primitive-icon><svg focusable="false" data-key="settings" aria-hidden="true" viewBox="0 0 52 52" class="slds-button__icon"><g><g><path d="M26.1 19.1c-3.9 0-7 3.1-7 7s3.1 7 7 7 7-3.1 7-7-3.1-7-7-7z"></path><path d="M47.1 32.4l-3.7-3.1c.2-1.1.3-2.3.3-3.4s-.1-2.3-.3-3.4l3.7-3.1c1.2-1 1.6-2.8.8-4.2l-1.6-2.8c-.6-1-1.7-1.6-2.9-1.6-.4 0-.8.1-1.1.2l-4.6 1.7c-1.8-1.6-3.8-2.7-5.9-3.4L31 4.6c-.3-1.6-1.7-2.5-3.3-2.5h-3.2c-1.6 0-3 .9-3.3 2.5l-.8 4.6c-2.2.7-4.2 1.9-6 3.4l-4.6-1.7c-.4-.1-.7-.2-1.1-.2-1.2 0-2.3.6-2.9 1.6l-1.6 2.8c-.8 1.4-.5 3.2.8 4.2l3.7 3.1c-.2 1.1-.3 2.3-.3 3.4 0 1.2.1 2.3.3 3.4L5 32.3c-1.2 1-1.6 2.8-.8 4.2l1.6 2.8c.6 1 1.7 1.6 2.9 1.6.4 0 .8-.1 1.1-.2l4.6-1.7c1.8 1.6 3.8 2.7 5.9 3.4l.8 4.8c.3 1.6 1.6 2.7 3.3 2.7h3.2c1.6 0 3-1.2 3.3-2.8l.8-4.8c2.3-.8 4.4-2 6.2-3.7l4.3 1.7c.4.1.8.2 1.2.2 1.2 0 2.3-.6 2.9-1.6l1.5-2.6c.9-1.1.5-2.9-.7-3.9zm-21 4.7c-6.1 0-11-4.9-11-11s4.9-11 11-11 11 4.9 11 11-4.9 11-11 11z"></path></g></g></svg></lightning-primitive-icon><lightning-primitive-icon><svg focusable="false" data-key="down" aria-hidden="true" viewBox="0 0 52 52" class="slds-button__icon slds-button__icon_x-small slds-m-left_xx-small"><g><path d="M8.3 14h35.4c1 0 1.7 1.3.9 2.2L27.3 37.4c-.6.8-1.9.8-2.5 0L7.3 16.2c-.7-.9-.1-2.2 1-2.2z"></path></g></svg></lightning-primitive-icon><span class="slds-assistive-text">List View Controls</span></button></lightning-button-menu></div></lst-list-view-manager-settings-menu><lst-list-view-manager-display-switcher lst-listviewmanagerheader_listviewmanagerheader="" class="slds-m-left_xx-small"></lst-list-view-manager-display-switcher><force-list-view-manager-button-bar lst-listviewmanagerheader_listviewmanagerheader=""><div class="slds-m-left_xx-small simpleEmptyState"><div class="slds-button-group"><lightning-button-icon class="forceRefreshButton"><button name="refreshButton" title="Refresh" type="button" class="slds-button slds-button_icon slds-button_icon-border-filled"><lightning-primitive-icon><svg focusable="false" data-key="refresh" aria-hidden="true" viewBox="0 0 52 52" class="slds-button__icon"><g><path d="M46.5 4h-3c-.8 0-1.5.7-1.5 1.5v7c0 .9-.5 1.3-1.2.7-.3-.4-.6-.7-1-1-5-5-12-7.1-19.2-5.7-2.5.5-4.9 1.5-7 2.9-6.1 4-9.6 10.5-9.7 17.5-.1 5.4 2 10.8 5.8 14.7 4 4.2 9.4 6.5 15.2 6.5 5.1 0 9.9-1.8 13.7-5 .7-.6.7-1.6.1-2.2l-2.1-2.1c-.5-.5-1.4-.6-2-.1-3.6 3-8.5 4.2-13.4 3-1.3-.3-2.6-.9-3.8-1.6C11.7 36.6 9 30 10.6 23.4c.3-1.3.9-2.6 1.6-3.8C15 14.7 19.9 12 25.1 12c4 0 7.8 1.6 10.6 4.4.5.4.9.9 1.2 1.4.3.8-.4 1.2-1.3 1.2h-7c-.8 0-1.5.7-1.5 1.5v3.1c0 .8.6 1.4 1.4 1.4h18.3c.7 0 1.3-.6 1.3-1.3V5.5C48 4.7 47.3 4 46.5 4z"></path></g></svg></lightning-primitive-icon><span class="slds-assistive-text">Refresh</span></button></lightning-button-icon></div></div></force-list-view-manager-button-bar></div></div><div lst-listviewmanagerheader_listviewmanagerheader=""><div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-p-left_xx-small actionsContainer"><runtime_platform_actions-actions-ribbon lst-listviewmanagerheader_listviewmanagerheader=""><slot name="actionsProvider"><runtime_platform_actions-provider-related-list lst-listviewmanagerheader_listviewmanagerheader="" slot="actionsProvider"><force-version-marker></force-version-marker></runtime_platform_actions-provider-related-list></slot><ul class="slds-button-group-list"><li class="visible"><runtime_platform_actions-action-renderer apiname="New" title="New"><runtime_platform_actions-executor-aura-legacy><slot><slot><lightning-button><button name="New" type="button" class="slds-button slds-button_neutral">New</button></lightning-button></slot></slot></runtime_platform_actions-executor-aura-legacy></runtime_platform_actions-action-renderer></li></ul></runtime_platform_actions-actions-ribbon></div></div></div><div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-grid"><div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-col slds-align-bottom"><p lst-listviewmanagerheader_listviewmanagerheader="" class="slds-text-body--small"><force-list-view-manager-status-info lst-listviewmanagerheader_listviewmanagerheader=""><div aria-live="polite" role="status"><span class="countSortedByFilteredBy">9 items • </span><span>Updated a minute ago</span></div></force-list-view-manager-status-info></p></div><div lst-listviewmanagerheader_listviewmanagerheader="" class="slds-col slds-no-flex slds-grid slds-align-bottom slds-shrink"></div></div></div> -->